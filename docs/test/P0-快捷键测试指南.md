# P0 快捷键功能测试指南

## 📍 快捷键设置位置

### 方法1：通过右键菜单
1. **右键点击宠物** → 弹出右键菜单
2. 点击菜单底部的 **「系统」** → **「设置中心」**
3. 在设置中心顶部，点击 **「智能助手」** 标签页
4. 向下滚动找到 **「快捷键设置」** 部分

### 方法2：通过托盘菜单
1. **点击系统托盘图标**（宠物图标）
2. 选择 **「设置」** 菜单项
3. 在设置中心顶部，点击 **「智能助手」** 标签页
4. 向下滚动找到 **「快捷键设置」** 部分

---

## 🎯 快速测试步骤

### 启动应用
```bash
pnpm tauri dev
```

### 第一步：配置快捷键

**在「智能助手」标签页的「快捷键设置」部分：**

| 设置项 | macOS | Windows/Linux |
|--------|-------|---------------|
| **打开聊天** | `Cmd+Shift+C` | `Ctrl+Shift+C` |
| **打开设置** | `Cmd+Shift+S` | `Ctrl+Shift+S` |

**注意：**
- ✅ 正确格式：`Cmd+Shift+C` 或 `Ctrl+Shift+C`
- ❌ 错误格式：`CmdOrCtrl+Shift+C`（虽然输入框有这个placeholder，但实际应填写平台特定的）

### 第二步：保存配置
1. 填写完快捷键后，点击设置窗口底部的 **「保存」** 按钮
2. 等待保存成功提示
3. 关闭设置窗口

### 第三步：测试快捷键

#### 测试 1：打开聊天窗口
1. 按下 `Cmd+Shift+C` (Mac) 或 `Ctrl+Shift+C` (Win)
2. **预期结果：** 聊天窗口弹出
3. 再次按下相同快捷键
4. **预期结果：** 聊天窗口聚焦（而非创建新窗口）

#### 测试 2：打开设置窗口
1. 按下 `Cmd+Shift+S` (Mac) 或 `Ctrl+Shift+S` (Win)
2. **预期结果：** 设置窗口弹出
3. 再次按下相同快捷键
4. **预期结果：** 设置窗口聚焦

---

## 🔍 验证日志输出

**打开开发者控制台**（在 Tauri 窗口按 `F12` 或右键检查）

### 成功的日志示例：

```
[ShortcutManager] Registered: openChat -> Cmd+Shift+C
[ShortcutManager] Registered: openSettings -> Cmd+Shift+S
[ShortcutManager] Shortcuts registered

# 按下快捷键后：
[ShortcutManager] Triggered: openChat
[WindowManager] Created new window: chat

# 窗口已存在时再次按快捷键：
[ShortcutManager] Triggered: openChat
[WindowManager] Focused existing window: chat
```

---

## ✅ 基础功能测试清单

- [ ] 1. 能找到设置中心
- [ ] 2. 能找到智能助手标签页
- [ ] 3. 能看到快捷键设置部分
- [ ] 4. 能成功填写快捷键
- [ ] 5. 能保存配置
- [ ] 6. 快捷键能打开聊天窗口
- [ ] 7. 快捷键能打开设置窗口
- [ ] 8. 窗口已存在时，快捷键能聚焦窗口
- [ ] 9. 右键菜单「聊天」仍然正常
- [ ] 10. 右键菜单「设置中心」仍然正常
- [ ] 11. 托盘菜单「设置」仍然正常

---

## ⚠️ 常见问题

### Q1: 快捷键不生效
**检查：**
1. 确认已点击「保存」按钮
2. 确认使用了正确的平台格式（Cmd vs Ctrl）
3. 检查控制台是否有冲突警告
4. 尝试不同的快捷键组合

### Q2: 窗口重复创建
**可能原因：**
- WindowManager 逻辑错误
- 请在控制台查看日志，应显示 "Focused existing window" 而非 "Created new window"

### Q3: 快捷键冲突
**系统保留键：**
- `Cmd+Q` / `Ctrl+Q` - 退出应用
- `Cmd+W` / `Ctrl+W` - 关闭窗口
- 选择其他组合即可

---

## 🎨 界面截图辅助

**设置中心位置：**
```
┌─────────────────────────────────────────┐
│  设置中心                           ✕   │
├─────────────────────────────────────────┤
│ [外观] [行为] [智能助手] [统计与成就]   │  ← 点击这个标签
│ [性能] [高级] [记忆管理]                │
├─────────────────────────────────────────┤
│                                         │
│  AI模型选择                              │
│  [模型提供方: GPT（OpenAI）▼]           │
│  [模型: gpt-4o-mini ▼]                  │
│  [API Key: **********]                  │
│                                         │
│  快捷键设置  ← ← ← 这里！                │
│  ┌───────────────────────────────────┐  │
│  │ 打开聊天: [Cmd+Shift+C          ] │  │
│  │ 打开设置: [Cmd+Shift+S          ] │  │
│  └───────────────────────────────────┘  │
│                                         │
│  语音识别（STT）                         │
│  ...                                    │
└─────────────────────────────────────────┘
           [保存]  [取消]  ← 记得保存！
```

---

## 📊 测试报告模板

**测试日期：** ________
**操作系统：** macOS / Windows / Linux
**测试人：** ________

### 测试结果

| 项目 | 通过 | 失败 | 备注 |
|------|------|------|------|
| 配置快捷键 | ☐ | ☐ | |
| 保存配置 | ☐ | ☐ | |
| 打开聊天窗口 | ☐ | ☐ | |
| 打开设置窗口 | ☐ | ☐ | |
| 窗口聚焦逻辑 | ☐ | ☐ | |
| 右键菜单 | ☐ | ☐ | |
| 托盘菜单 | ☐ | ☐ | |

### 发现的问题
1.
2.
3.

---

**准备好开始测试了吗？启动应用吧！** 🚀
```bash
pnpm tauri dev
```
