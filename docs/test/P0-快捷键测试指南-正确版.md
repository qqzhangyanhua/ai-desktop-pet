# P0 快捷键功能 - 正确测试指南

## 📍 快捷键设置位置（游戏化界面）

### 第一步：打开设置窗口
- **方式1**：右键点击宠物 → 点击「设置中心」
- **方式2**：点击系统托盘图标 → 选择「设置」

### 第二步：进入智能助手页面
在设置窗口的**主界面**，点击以下任意一个卡片：

1. ✅ **「语音交流」** - 蓝色卡片（左上角，麦克风🎤图标）
2. ✅ **「隐私设置」** - 紫色卡片（右下角，盾牌🛡️图标）

**这两个按钮都会进入同一个页面（智能助手设置）！**

### 第三步：找到快捷键设置
进入智能助手页面后，向下滚动，你会看到：

```
┌─────────────────────────────────────────┐
│  AI模型选择                              │
│  ├─ 模型提供方                           │
│  ├─ 模型                                 │
│  ├─ API Key                              │
│  └─ Temperature                          │
│                                         │
│  快捷键设置  ← ← ← 在这里！              │
│  ┌───────────────────────────────────┐  │
│  │ 打开聊天: [                      ] │  │
│  │ 打开设置: [                      ] │  │
│  └───────────────────────────────────┘  │
│                                         │
│  语音识别（STT）                         │
│  ...                                    │
└─────────────────────────────────────────┘
```

---

## 🎯 测试步骤（完整版）

### 1. 配置快捷键

**在「快捷键设置」部分填写：**

| 设置项 | macOS | Windows/Linux |
|--------|-------|---------------|
| **打开聊天** | `Cmd+Shift+C` | `Ctrl+Shift+C` |
| **打开设置** | `Cmd+Shift+S` | `Ctrl+Shift+S` |

**注意格式：**
- ✅ 正确：`Cmd+Shift+C` 或 `Ctrl+Shift+C`
- ❌ 错误：`CmdOrCtrl+Shift+C`（虽然输入框提示这样，但要按平台填写）

### 2. 保存配置

1. 填写完快捷键后，点击页面底部的 **「保存」** 按钮
2. 等待保存成功提示
3. 可以关闭设置窗口

### 3. 测试快捷键功能

#### 测试 A：打开聊天窗口
1. 按下快捷键：
   - macOS: `Cmd + Shift + C`
   - Windows/Linux: `Ctrl + Shift + C`
2. **预期：** 聊天窗口弹出
3. 再次按下相同快捷键
4. **预期：** 聊天窗口聚焦（不会重复创建）

#### 测试 B：打开设置窗口
1. 按下快捷键：
   - macOS: `Cmd + Shift + S`
   - Windows/Linux: `Ctrl + Shift + S`
2. **预期：** 设置窗口弹出
3. 再次按下相同快捷键
4. **预期：** 设置窗口聚焦

---

## 🔍 验证日志（可选）

**打开开发者控制台验证：**
1. 在宠物窗口或聊天窗口按 `F12`
2. 切换到 Console（控制台）标签
3. 按下快捷键后查看日志：

**成功的日志示例：**
```
[ShortcutManager] Registered: openChat -> Cmd+Shift+C
[ShortcutManager] Registered: openSettings -> Cmd+Shift+S

# 按下快捷键后：
[ShortcutManager] Triggered: openChat
[WindowManager] Created new window: chat

# 窗口已存在时：
[ShortcutManager] Triggered: openChat
[WindowManager] Focused existing window: chat
```

---

## ✅ 测试检查清单

- [ ] 1. 能打开设置窗口
- [ ] 2. 能点击「语音交流」或「隐私设置」进入智能助手页面
- [ ] 3. 能看到「快捷键设置」部分
- [ ] 4. 能填写快捷键配置
- [ ] 5. 能保存配置
- [ ] 6. 快捷键能打开聊天窗口
- [ ] 7. 快捷键能打开设置窗口
- [ ] 8. 窗口已存在时，快捷键能聚焦窗口（不重复创建）
- [ ] 9. 右键菜单「聊天」仍然正常工作
- [ ] 10. 右键菜单「设置中心」仍然正常工作
- [ ] 11. 托盘菜单「设置」仍然正常工作

---

## 🎨 界面示意图

```
┌────────────────────────────────────────────────────────┐
│  设置中心 - 主界面                                      │
├────────────────────────────────────────────────────────┤
│                                                        │
│  [左侧宠物信息面板]      [右侧功能卡片区域]             │
│  ┌──────────────┐       ┌──────────┬──────────┐       │
│  │  [宠物头像]  │       │ 语音交流  │ 动作表情  │       │
│  │              │       │  (蓝色)   │  (橙色)   │ ← 点击蓝色卡片
│  │ 昵称：我的宠物│       ├──────────┼──────────┤       │
│  │ 阶段：陪生期  │       │ 好友拜访  │ 分享成就  │       │
│  │ 心情：100/100│       │  (绿色)   │  (粉色)   │       │
│  │ 精力：100/100│       ├──────────┼──────────┤       │
│  │              │       │ 消息通知  │ 隐私设置  │       │
│  │ [亲密度进度条]│       │  (橙色)   │  (紫色)   │ ← 或点击紫色卡片
│  └──────────────┘       └──────────┴──────────┘       │
│                                                        │
│  [喂养宠物] [工作学习] [商城道具] [主页]               │
└────────────────────────────────────────────────────────┘

↓ 点击「语音交流」或「隐私设置」后 ↓

┌────────────────────────────────────────────────────────┐
│  设置中心 - 智能助手页面                                │
├────────────────────────────────────────────────────────┤
│  [← 返回]                                              │
│                                                        │
│  AI模型选择                                             │
│  ├─ 模型提供方: [GPT（OpenAI） ▼]                      │
│  ├─ 模型: [gpt-4o-mini ▼]                              │
│  ├─ API Key: [**********]                             │
│  └─ Temperature: [●─────] 0.7                          │
│                                                        │
│  快捷键设置 ← ← ← 在这里填写！                          │
│  ┌──────────────────────────────────────────────────┐ │
│  │ 打开聊天: [Cmd+Shift+C                          ] │ │
│  │ 打开设置: [Cmd+Shift+S                          ] │ │
│  └──────────────────────────────────────────────────┘ │
│                                                        │
│  语音识别（STT）                                        │
│  ...                                                   │
│                                                        │
│                            [保存] [取消]  ← 记得保存！  │
└────────────────────────────────────────────────────────┘
```

---

## ⚠️ 常见问题

### Q1: 点击「语音交流」后没反应
**可能原因：**
- 页面加载中，稍等片刻
- 控制台是否有错误日志

### Q2: 快捷键填写后保存失败
**检查：**
1. 是否使用了正确格式（Cmd+Shift+C）
2. 是否与系统快捷键冲突
3. 查看控制台错误信息

### Q3: 快捷键不生效
**检查：**
1. 确认已点击「保存」按钮
2. 尝试关闭设置窗口后重新打开应用
3. 检查控制台日志

---

## 🚀 开始测试

```bash
pnpm tauri dev
```

1. 打开设置窗口
2. 点击「语音交流」（蓝色）或「隐私设置」（紫色）
3. 找到「快捷键设置」部分
4. 填写并保存
5. 测试快捷键功能！

**祝测试顺利！** 🎉
