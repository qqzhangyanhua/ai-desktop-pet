# Live2D ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

æœ¬é¡¹ç›®æ”¯æŒä½¿ç”¨ Live2D æ¨¡å‹ä½œä¸ºæ¡Œé¢å® ç‰©çš„ä¸»å½¢è±¡ï¼Œæä¾›æ›´ç”ŸåŠ¨çš„åŠ¨ç”»æ•ˆæœå’Œäº¤äº’ä½“éªŒã€‚

## åŠŸèƒ½ç‰¹æ€§

### âœ¨ æ ¸å¿ƒåŠŸèƒ½
- ğŸ­ **Live2D æ¨¡å‹æ¸²æŸ“**ï¼šåŸºäº oh-my-live2d åº“å®ç°é«˜æ€§èƒ½æ¸²æŸ“
- ğŸ¬ **åŠ¨ä½œç³»ç»Ÿ**ï¼šæ”¯æŒå¤šç§å® ç‰©åŠ¨ä½œï¼ˆå–‚é£Ÿã€ç©è€ã€ç¡è§‰ã€å·¥ä½œç­‰ï¼‰
- ğŸ’¬ **æ¶ˆæ¯æç¤º**ï¼šæ¨¡å‹å¯ä»¥æ˜¾ç¤ºæ°”æ³¡æ¶ˆæ¯
- ğŸ”Š **è¯­éŸ³è”åŠ¨**ï¼šè¯´è¯æ—¶æ¨¡å‹ä¼šæœ‰è½»å¾®æ‘†åŠ¨æ•ˆæœ
- âš¡ **åŠ¨ç”»æ•ˆæœ**ï¼šç¼©æ”¾ã€æ—‹è½¬ã€å¼¹è·³ç­‰åŠ¨ç”»æ•ˆæœ

### ğŸ¨ æ”¯æŒçš„åŠ¨ä½œç±»å‹
- **å–‚é£Ÿ** (feed)ï¼šæ¨¡å‹æ”¾å¤§å¹¶æ˜¾ç¤ºåƒä¸œè¥¿åŠ¨ç”»
- **ç©è€** (play)ï¼šæ¨¡å‹å¼¹è·³è·³è·ƒ
- **ç¡è§‰** (sleep)ï¼šæ¨¡å‹æ·¡å‡ºä¼‘æ¯
- **å·¥ä½œ** (work)ï¼šæ¨¡å‹å·¦å³æ‘‡æ‘†
- **å˜èº«** (transform)ï¼šåˆ‡æ¢æ¨¡å‹æœè£…æˆ–å½¢è±¡
- **éŸ³ä¹** (music)ï¼šæ¨¡å‹éšéŸ³ä¹æ‘‡æ‘†
- **èˆè¹ˆ** (dance)ï¼šæ¨¡å‹è·³èˆåŠ¨ç”»
- **é­”æœ¯** (magic)ï¼šæ¨¡å‹æ—‹è½¬ç‰¹æ•ˆ
- **è‰ºæœ¯** (art)ï¼šç”Ÿæˆè‰ºæœ¯ä½œå“æ—¶çš„åŠ¨ç”»
- **æ¸…æ´** (clean)ï¼šæ¸…æ´åŠ¨ç”»
- **æ¢³æ¯›** (brush)ï¼šæ¢³æ¯›åŠ¨ç”»
- **ä¼‘æ¯** (rest)ï¼šæ”¾æ¾åŠ¨ç”»

## å¿«é€Ÿå¼€å§‹

### 1. å¯ç”¨ Live2D

æœ‰ä¸¤ç§æ–¹å¼å¯ç”¨ Live2Dï¼š

#### æ–¹å¼ä¸€ï¼šé€šè¿‡è®¾ç½®ç•Œé¢ï¼ˆæ¨èï¼‰
1. å³é”®ç‚¹å‡»å® ç‰©æ‰“å¼€èœå•
2. é€‰æ‹©"è®¾ç½®"
3. è¿›å…¥"å¤–è§‚"æ ‡ç­¾
4. å‹¾é€‰"å¯ç”¨ Live2D"
5. é‡å¯åº”ç”¨

#### æ–¹å¼äºŒï¼šç›´æ¥ä¿®æ”¹é…ç½®
åœ¨æ•°æ®åº“é…ç½®ä¸­è®¾ç½®ï¼š
```json
{
  "live2d": {
    "useLive2D": true,
    "currentModel": "white-cat",
    "modelScale": 1.0
  },
  "useLive2D": true
}
```

### 2. æ¨¡å‹æ–‡ä»¶é…ç½®

é»˜è®¤ä½¿ç”¨çš„æ¨¡å‹ä½äºï¼š
```
public/whitecatfree_vts/
  â”œâ”€â”€ white-cat.model3.json    # æ¨¡å‹é…ç½®æ–‡ä»¶
  â”œâ”€â”€ white-cat.moc3           # æ¨¡å‹æ•°æ®æ–‡ä»¶
  â”œâ”€â”€ white-cat.physics3.json  # ç‰©ç†æ•ˆæœé…ç½®
  â”œâ”€â”€ white-cat.cdi3.json      # æ˜¾ç¤ºä¿¡æ¯
  â”œâ”€â”€ white-cat.2048/          # è´´å›¾æ–‡ä»¶å¤¹
  â”‚   â””â”€â”€ texture_00.png       # è´´å›¾æ–‡ä»¶
  â””â”€â”€ *.exp3.json              # è¡¨æƒ…æ–‡ä»¶
```

### 3. æ·»åŠ è‡ªå®šä¹‰æ¨¡å‹

#### æ­¥éª¤ï¼š
1. å°† Live2D æ¨¡å‹æ–‡ä»¶æ”¾å…¥ `public/` ç›®å½•çš„å­æ–‡ä»¶å¤¹ä¸­
2. åœ¨ `src/components/pet/Live2DPet.tsx` çš„ `DEFAULT_MODELS` ä¸­æ·»åŠ é…ç½®ï¼š

```typescript
{
  name: 'my-model',
  path: '/my-model-folder/model.model3.json',
  scale: 0.15,
  position: [0, 60],
  stageStyle: {
    height: 400,
    width: 300,
  },
}
```

#### å‚æ•°è¯´æ˜ï¼š
- `name`: æ¨¡å‹åç§°ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
- `path`: æ¨¡å‹é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹äº public ç›®å½•ï¼‰
- `scale`: æ¨¡å‹ç¼©æ”¾æ¯”ä¾‹ï¼ˆ0.1 - 2.0ï¼‰
- `position`: æ¨¡å‹ä½ç½® [x, y]
- `stageStyle`: èˆå°å°ºå¯¸

## æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šLive2D æ¨¡å‹æ— æ³•åŠ è½½

#### æ£€æŸ¥æ­¥éª¤ï¼š

1. **æ‰“å¼€å¼€å‘è€…å·¥å…·**
   - æŒ‰ `F12` æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
   - æŸ¥çœ‹ Console æ ‡ç­¾çš„é”™è¯¯ä¿¡æ¯
   - æŸ¥çœ‹ Network æ ‡ç­¾çš„ç½‘ç»œè¯·æ±‚

2. **æ£€æŸ¥æ¨¡å‹æ–‡ä»¶**
   ```bash
   # ç¡®è®¤æ¨¡å‹æ–‡ä»¶å­˜åœ¨
   ls public/whitecatfree_vts/
   
   # åº”è¯¥çœ‹åˆ°ï¼š
   # white-cat.model3.json
   # white-cat.moc3
   # white-cat.physics3.json
   # white-cat.2048/texture_00.png
   ```

3. **æ£€æŸ¥æ–‡ä»¶è·¯å¾„**
   - æ¨¡å‹è·¯å¾„å¿…é¡»ç›¸å¯¹äº `public/` ç›®å½•
   - è·¯å¾„ä»¥ `/` å¼€å¤´
   - ç¤ºä¾‹ï¼š`/whitecatfree_vts/white-cat.model3.json`

4. **æ£€æŸ¥ç½‘ç»œè¯·æ±‚**
   - åœ¨ Network æ ‡ç­¾ä¸­æœç´¢æ¨¡å‹æ–‡ä»¶å
   - ç¡®è®¤è¯·æ±‚çŠ¶æ€ç ä¸º 200
   - å¦‚æœæ˜¯ 404ï¼Œæ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®
   - å¦‚æœæ˜¯ CORS é”™è¯¯ï¼Œæ£€æŸ¥æœåŠ¡å™¨é…ç½®

5. **ä½¿ç”¨è¯Šæ–­å·¥å…·**
   ```typescript
   // åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
   import { getLive2DManager } from './services/live2d';
   const manager = getLive2DManager();
   console.log('Is initialized:', manager.isInitialized());
   console.log('State:', manager.getState());
   ```

### é—®é¢˜ï¼šæ¨¡å‹æ˜¾ç¤ºä¸æ­£ç¡®

#### å¯èƒ½çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼š

1. **æ¨¡å‹è¿‡å¤§æˆ–è¿‡å°**
   - è°ƒæ•´ `scale` å‚æ•°ï¼ˆå»ºè®®èŒƒå›´ 0.1 - 0.3ï¼‰
   - è°ƒæ•´ `position` å‚æ•°

2. **æ¨¡å‹ä½ç½®åç§»**
   - ä¿®æ”¹ `position` çš„ [x, y] å€¼
   - x: å·¦å³ä½ç½®ï¼ˆ0 ä¸ºä¸­å¿ƒï¼‰
   - y: ä¸Šä¸‹ä½ç½®ï¼ˆæ•°å€¼è¶Šå¤§è¶Šé ä¸‹ï¼‰

3. **èˆå°å°ºå¯¸ä¸åˆé€‚**
   - è°ƒæ•´ `stageStyle` çš„ width å’Œ height
   - ç¡®ä¿ä¸çª—å£å°ºå¯¸åŒ¹é…

### é—®é¢˜ï¼šæ¨¡å‹åŠ è½½å¾ˆæ…¢

#### ä¼˜åŒ–å»ºè®®ï¼š

1. **ä½¿ç”¨æœ¬åœ°æ¨¡å‹**
   - ä¸è¦ä½¿ç”¨ CDN è¿œç¨‹æ¨¡å‹
   - å°†æ¨¡å‹æ–‡ä»¶æ”¾åœ¨ `public/` ç›®å½•

2. **å‹ç¼©è´´å›¾**
   - ä½¿ç”¨å‹ç¼©çš„ PNG æˆ– WebP æ ¼å¼
   - å‡å°è´´å›¾å°ºå¯¸ï¼ˆå¦‚ 2048x2048 â†’ 1024x1024ï¼‰

3. **ç®€åŒ–æ¨¡å‹**
   - å‡å°‘è¡¨æƒ…å’ŒåŠ¨ä½œæ–‡ä»¶
   - ä½¿ç”¨è¾ƒä½å¤šè¾¹å½¢æ•°é‡çš„æ¨¡å‹

## æµ‹è¯•é¡µé¢

é¡¹ç›®åŒ…å«ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•é¡µé¢ç”¨äºå¿«é€ŸéªŒè¯ Live2D åŠŸèƒ½ï¼š

### ä½¿ç”¨æ–¹æ³•ï¼š

1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
   ```bash
   pnpm dev
   ```

2. è®¿é—®æµ‹è¯•é¡µé¢ï¼š
   ```
   http://localhost:1420/test.html
   ```

3. ç‚¹å‡»"åŠ è½½ Live2D"æŒ‰é’®

4. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—å’Œ Network è¯·æ±‚

### æµ‹è¯•é¡µé¢åŠŸèƒ½ï¼š
- âœ… åŠ è½½ Live2D æ¨¡å‹
- âœ… æµ‹è¯•åŠ¨ä½œæ•ˆæœ
- âœ… æ˜¾ç¤ºæ¶ˆæ¯æç¤º
- âœ… å®æ—¶æ—¥å¿—è¾“å‡º
- âœ… è¯Šæ–­ä¿¡æ¯å±•ç¤º

## API å‚è€ƒ

### Live2DManager

ä¸»è¦ç®¡ç†ç±»ï¼Œç”¨äºæ§åˆ¶ Live2D æ¨¡å‹ã€‚

#### åˆå§‹åŒ–
```typescript
import { getLive2DManager } from './services/live2d';

const manager = getLive2DManager();
await manager.init(models, {
  dockedPosition: 'right',
  primaryColor: '#58b0fc',
  onStateChange: (state) => {
    console.log('State changed:', state);
  },
});
```

#### åŸºæœ¬æ“ä½œ
```typescript
// æ˜¾ç¤ºæ¶ˆæ¯
manager.showMessage('ä½ å¥½!', 3000);

// æ’­æ”¾åŠ¨ä½œ
manager.playAction('feed');

// è§¦å‘æƒ…ç»ª
manager.triggerEmotion('happy');

// è®¾ç½®è¯´è¯çŠ¶æ€
manager.setSpeaking(true);

// æ˜¾ç¤º/éšè—
await manager.show();
await manager.hide();

// åŠ è½½å…¶ä»–æ¨¡å‹
await manager.loadModel(1);
await manager.loadNextModel();
```

#### çŠ¶æ€æŸ¥è¯¢
```typescript
// è·å–å½“å‰çŠ¶æ€
const state = manager.getState();
console.log(state.isLoaded);
console.log(state.currentModel);
console.log(state.currentModelIndex);

// æ£€æŸ¥æ˜¯å¦å·²åˆå§‹åŒ–
const isInit = manager.isInitialized();
```

### useLive2D Hook

React Hookï¼Œç”¨äºåœ¨ç»„ä»¶ä¸­ä½¿ç”¨ Live2Dã€‚

```typescript
import { useLive2D } from './hooks';

function MyComponent() {
  const {
    state,
    isReady,
    error,
    showMessage,
    triggerEmotion,
  } = useLive2D({
    models: DEFAULT_MODELS,
    dockedPosition: 'right',
    autoInit: true,
  });

  if (error) {
    return <div>Error: {error.message}</div>;
  }

  if (!isReady) {
    return <div>Loading...</div>;
  }

  return (
    <button onClick={() => showMessage('Hello!')}>
      Say Hello
    </button>
  );
}
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æŒ‰éœ€åŠ è½½**
   - Live2D åº“ä½¿ç”¨æ‡’åŠ è½½ï¼Œåªæœ‰å¯ç”¨æ—¶æ‰ä¼šåŠ è½½
   - å‡å°é¦–å±åŠ è½½ä½“ç§¯

2. **ç¼“å­˜æ¨¡å‹**
   - æµè§ˆå™¨ä¼šè‡ªåŠ¨ç¼“å­˜æ¨¡å‹æ–‡ä»¶
   - é¦–æ¬¡åŠ è½½åé€Ÿåº¦ä¼šæ›´å¿«

3. **é™åˆ¶åŠ¨ç”»**
   - é¿å…é¢‘ç¹è§¦å‘åŠ¨ä½œ
   - ä½¿ç”¨èŠ‚æµ/é˜²æŠ–å¤„ç†ç”¨æˆ·äº¤äº’

4. **èµ„æºæ¸…ç†**
   - ç»„ä»¶å¸è½½æ—¶ä¸ä¼šç«‹å³é”€æ¯ Live2D
   - ä¿æŒå•ä¾‹æ¨¡å¼å‡å°‘é‡å¤åŠ è½½

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆå¯ç”¨ Live2D åéœ€è¦é‡å¯ï¼Ÿ
A: Live2D çš„åˆå§‹åŒ–éœ€è¦åœ¨åº”ç”¨å¯åŠ¨æ—¶è¿›è¡Œï¼Œç¡®ä¿èµ„æºæ­£ç¡®åŠ è½½ã€‚

### Q: å¯ä»¥åŒæ—¶æ˜¾ç¤ºå¤šä¸ªæ¨¡å‹å—ï¼Ÿ
A: å½“å‰ç‰ˆæœ¬åªæ”¯æŒå•ä¸ªæ¨¡å‹ï¼Œä½†å¯ä»¥é€šè¿‡åˆ‡æ¢æ¨¡å‹æ¥å®ç°å¤šæ ·æ€§ã€‚

### Q: å¦‚ä½•å¯¼å…¥å…¶ä»– Live2D æ¨¡å‹ï¼Ÿ
A: å°†æ¨¡å‹æ–‡ä»¶æ”¾å…¥ `public/` ç›®å½•ï¼Œå¹¶åœ¨é…ç½®ä¸­æ·»åŠ è·¯å¾„å³å¯ã€‚

### Q: æ”¯æŒ Live2D Cubism çš„å“ªäº›ç‰ˆæœ¬ï¼Ÿ
A: æ”¯æŒ Cubism 2.x å’Œ 3.x ç‰ˆæœ¬çš„æ¨¡å‹ã€‚

### Q: æ¨¡å‹åŠ è½½å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
A: å‚è€ƒ"æ•…éšœæ’æŸ¥"ç« èŠ‚ï¼Œä½¿ç”¨æµ‹è¯•é¡µé¢å’Œè¯Šæ–­å·¥å…·å®šä½é—®é¢˜ã€‚

## ç›¸å…³æ–‡æ¡£

- [oh-my-live2d æ–‡æ¡£](https://oml2d.com/)
- [Live2D Cubism å®˜æ–¹æ–‡æ¡£](https://docs.live2d.com/)
- [é¡¹ç›® README](../README.md)
- [æ€§èƒ½ä¼˜åŒ–æŒ‡å—](./PERFORMANCE_OPTIMIZATION.md)

## æ›´æ–°æ—¥å¿—

### v0.1.0
- âœ¨ åˆå§‹å®ç° Live2D é›†æˆ
- âœ¨ æ”¯æŒåŸºæœ¬åŠ¨ä½œç³»ç»Ÿ
- âœ¨ æ·»åŠ è¯­éŸ³è”åŠ¨åŠŸèƒ½
- âœ¨ åˆ›å»ºæµ‹è¯•é¡µé¢å’Œè¯Šæ–­å·¥å…·
- ğŸ› ä¿®å¤é…ç½®ä¸ä¸€è‡´é—®é¢˜
- ğŸ› ä¼˜åŒ–åˆå§‹åŒ–æ—¶æœºå’Œé”™è¯¯å¤„ç†
- ğŸ“ å®Œå–„æ–‡æ¡£å’Œæ—¥å¿—

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æ Issue æˆ– PRï¼
