<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è·¯å¾„è¯Šæ–­å·¥å…·</title>
  <style>
    body {
      font-family: 'Monaco', 'Courier New', monospace;
      padding: 20px;
      background: #1e1e1e;
      color: #d4d4d4;
    }
    .section {
      margin: 20px 0;
      padding: 15px;
      background: #2d2d2d;
      border-radius: 8px;
      border-left: 4px solid #007acc;
    }
    h2 {
      color: #4ec9b0;
      margin-top: 0;
    }
    pre {
      background: #1e1e1e;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
    }
    .success { color: #4ec9b0; }
    .error { color: #f48771; }
    .warn { color: #dcdcaa; }
    button {
      background: #007acc;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #005a9e;
    }
  </style>
</head>
<body>
  <h1>ğŸ” Tauri è·¯å¾„è¯Šæ–­å·¥å…·</h1>
  
  <div class="section">
    <h2>1. å½“å‰ç¯å¢ƒä¿¡æ¯</h2>
    <pre id="env-info"></pre>
  </div>

  <div class="section">
    <h2>2. æµ‹è¯•ç»å¯¹è·¯å¾„è®¿é—®</h2>
    <button onclick="testPath('/whitecatfree_vts/white-cat.model3.json')">æµ‹è¯• /whitecatfree_vts/...</button>
    <pre id="absolute-result"></pre>
  </div>

  <div class="section">
    <h2>3. æµ‹è¯•ç›¸å¯¹è·¯å¾„è®¿é—®</h2>
    <button onclick="testPath('./whitecatfree_vts/white-cat.model3.json')">æµ‹è¯• ./whitecatfree_vts/...</button>
    <pre id="relative-result"></pre>
  </div>

  <div class="section">
    <h2>4. æµ‹è¯•ä¸åŒåŸºå‡†è·¯å¾„</h2>
    <button onclick="testPath('whitecatfree_vts/white-cat.model3.json')">æµ‹è¯• whitecatfree_vts/...</button>
    <pre id="base-result"></pre>
  </div>

  <div class="section">
    <h2>5. æµ‹è¯•å®Œæ•´ URL</h2>
    <button onclick="testFullUrl()">æµ‹è¯•å®Œæ•´ URL æ„é€ </button>
    <pre id="full-url-result"></pre>
  </div>

  <script>
    // æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
    function showEnvInfo() {
      const info = {
        'location.href': location.href,
        'location.origin': location.origin,
        'location.protocol': location.protocol,
        'location.hostname': location.hostname,
        'location.pathname': location.pathname,
        'document.baseURI': document.baseURI,
        'window.__TAURI__': typeof window.__TAURI__ !== 'undefined' ? 'Available' : 'Not available',
        'User Agent': navigator.userAgent,
      };
      
      document.getElementById('env-info').textContent = JSON.stringify(info, null, 2);
    }

    // æµ‹è¯•è·¯å¾„è®¿é—®
    async function testPath(path) {
      const resultId = path.startsWith('/') ? 'absolute-result' : 
                       path.startsWith('./') ? 'relative-result' : 'base-result';
      const resultEl = document.getElementById(resultId);
      
      resultEl.innerHTML = `<span class="warn">æ­£åœ¨æµ‹è¯•: ${path}</span>\n`;
      
      const fullUrl = new URL(path, document.baseURI).href;
      resultEl.innerHTML += `å®Œæ•´ URL: ${fullUrl}\n\n`;
      
      try {
        const startTime = performance.now();
        const response = await fetch(path);
        const endTime = performance.now();
        const duration = (endTime - startTime).toFixed(2);
        
        if (response.ok) {
          const text = await response.text();
          const preview = text.substring(0, 200);
          resultEl.innerHTML += `<span class="success">âœ… æˆåŠŸ!</span>\n`;
          resultEl.innerHTML += `çŠ¶æ€: ${response.status} ${response.statusText}\n`;
          resultEl.innerHTML += `è€—æ—¶: ${duration}ms\n`;
          resultEl.innerHTML += `å†…å®¹ç±»å‹: ${response.headers.get('content-type')}\n`;
          resultEl.innerHTML += `å†…å®¹å¤§å°: ${text.length} bytes\n`;
          resultEl.innerHTML += `å†…å®¹é¢„è§ˆ:\n${preview}...\n`;
        } else {
          resultEl.innerHTML += `<span class="error">âŒ å¤±è´¥!</span>\n`;
          resultEl.innerHTML += `çŠ¶æ€: ${response.status} ${response.statusText}\n`;
        }
      } catch (error) {
        resultEl.innerHTML += `<span class="error">âŒ é”™è¯¯!</span>\n`;
        resultEl.innerHTML += `é”™è¯¯ä¿¡æ¯: ${error.message}\n`;
        resultEl.innerHTML += `é”™è¯¯å †æ ˆ:\n${error.stack}\n`;
      }
    }

    // æµ‹è¯•å®Œæ•´ URL æ„é€ 
    async function testFullUrl() {
      const resultEl = document.getElementById('full-url-result');
      
      const paths = [
        '/whitecatfree_vts/white-cat.model3.json',
        './whitecatfree_vts/white-cat.model3.json',
        'whitecatfree_vts/white-cat.model3.json',
      ];
      
      let output = '';
      for (const path of paths) {
        const fullUrl = new URL(path, document.baseURI).href;
        output += `è·¯å¾„: ${path}\n`;
        output += `è§£æä¸º: ${fullUrl}\n`;
        output += `---\n`;
      }
      
      // æµ‹è¯• window.location å„ç§ç»„åˆ
      output += '\nåŸºäº location.origin:\n';
      for (const path of paths) {
        const cleaned = path.replace(/^\.\//, '').replace(/^\//, '');
        const fullUrl = `${location.origin}/${cleaned}`;
        output += `${path} -> ${fullUrl}\n`;
      }
      
      resultEl.textContent = output;
    }

    // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
    window.addEventListener('DOMContentLoaded', () => {
      showEnvInfo();
    });
  </script>
</body>
</html>
